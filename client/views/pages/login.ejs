<div class="login box-shadow page-section">
    <label><b>Sign In</b></label>

    <div class="form-group">
        <label>Email address</label>
        <input id="email" type="email" class="form-control">
        <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
    </div>
    <div class="form-group">
        <label>Password</label>
        <input id="password" type="password" class="form-control">
    </div>
    <div class="form-group form-check">
        <input id="show-password" type="checkbox" class="form-check-input">
        <label class="form-check-label">Show Password</label>
    </div>
    <div class="form-group form-check">
        <input id="remember" type="checkbox" class="form-check-input">
        <label class="form-check-label">Remember Me</label>
    </div>
    <button id="login-btn" class="btn btn-primary">Login</button>
    <button id="google-btn" class="btn btn-danger">Google Login</button>
</div>

<div class="login box-shadow page-section">
    <label><b>Help</b></label>
    <div class="form-group">
        <a href="/auth/signup">
            <button id="signup-btn" class="btn btn-primary">Signup?</button>
        </a>
        <a href="/auth/signup">
            <button id="reset-btn" class="btn btn-primary">Reset Password?</button>
        </a>
    </div>
</div>

<script>
    document.getElementById("show-password").addEventListener('change', showPassword);
    document.getElementById("login-btn").addEventListener("click", login);
    document.getElementById("google-btn").addEventListener("click", googleLogin);
    document.getElementById("reset-btn").addEventListener("click", resetPassword);


    function showPassword() {
        let value = document.getElementById("password").type;
        document.getElementById("password").type = value === "password" ? "text" : "password";
    }

    function login() {
        resetCards();

        let email = document.getElementById("email")?.value;
        let pass = document.getElementById("password")?.value;
        let remember = document.getElementById("remember")?.checked;
        let url = window.location.origin + "/api/v1/auth/login"
        let success = window.location.origin + "/"

        fetch(url, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                email: email,
                password: pass,
                expires: !remember
            })
        })
            .then(response => response.json())
            .then(data => {
                console.log(data);
                if (!data.success) {
                    errorCard.style.display = "block";
                    data.errors.forEach(error => {
                        errorCard.innerHTML += `<b> - \t${error}<br/></b>`;
                    });
                } else {

                    // window.location.href = success
                    window.localStorage.setItem("token", data.token);
                    window.localStorage.setItem("admin", data.admin);
                    data.displayName ? window.localStorage.setItem("displayName", data.displayName) :
                        null;
                    setTimeout(renewToken, 1000 * 60 * TOKEN_TIMEOUT_MINS);
                }
                loadingCard.style.display = "none";
            });
    }

    function googleLogin() {

    }

    function resetPassword () {

    }
</script>
